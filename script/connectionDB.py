import os
from six.moves import urllib

filename = "gyro2"

from pymongo import MongoClient
from bson import ObjectId

try: 
    
    USER = urllib.parse.quote_plus(os.getenv('DB_USER'))
    PASSWORD = urllib.parse.quote_plus(os.environ.get('DB_PASSWORD'))
except: 
    #import credentials
    USER = "admin"
    PASSWORD = "H1d3n*PH0N3!"
print(USER,PASSWORD)
client = MongoClient()
client = MongoClient('mongodb://%s:%s@54.152.156.242' % (USER, PASSWORD)) # 54.235.235.226
print(client)
db_name = 'firstdb'
db = client[db_name]

def postPosts(data):
    posts = db.posts
    result = posts.insert_one(data)
    return result
def getDb(dBFilter = None,verbose=False):
    posts = db.posts
    if verbose:
        for post in posts.find(dBFilter):
            print(post["id"])
            print(post["accelerometerRecords"])
    return posts

def postPart(accelerometerSamples,buttonRecords,id,comment):
    '''id of the origin record to find it later'''
    collection = db.samples
    sample = {'id':id, 'accelerometerSamples':accelerometerSamples,'buttonRecords':buttonRecords,'comment':comment}
    collection.insert_one(sample)

def getPart(dBFilter = None,verbose=False):
    samples = db.samples
    print(samples)
    if verbose:
        for sample in samples.find(dBFilter):
            print(sample["id"])
            print(sample["accelerometerSamples"])
            print(sample["buttonRecords"])
    return samples

