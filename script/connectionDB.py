import os
from six.moves import urllib

filename = "gyro2"

from pymongo import MongoClient
from bson import ObjectId

try: 
    
    USER = urllib.parse.quote_plus(os.getenv('DB_USER'))
    PASSWORD = urllib.parse.quote_plus(os.environ.get('DB_PASSWORD'))
except: 
    import credentials
    USER = credentials._username
    PASSWORD = credentials._password
print(USER,PASSWORD)
client = MongoClient()
client = MongoClient('mongodb://%s:%s@54.152.156.242' % (USER, PASSWORD))
print(client)
db_name = 'firstdb'
db = client[db_name]


def getDb(dBFilter = None,verbose=False):
    posts = db.posts
    if verbose:
        for post in posts.find(dBFilter):
            print(post["id"])
            print(post["accelerometerRecords"])
    return posts

def postPart(accelerometerSamples,buttonRecords,id):
    '''id of the origin record to find it later'''
    collection = db.samples
    sample = {'id':id, 'accelerometerSamples':accelerometerSamples,'buttonRecords':buttonRecords}
    collection.insert_one(sample)

def getPart(dBFilter = None,verbose=False):
    samples = db.samples
    print(samples)
    if verbose:
        for sample in samples.find(dBFilter):
            print(sample["id"])
            print(sample["accelerometerSamples"])
            print(sample["buttonRecords"])
    return samples

