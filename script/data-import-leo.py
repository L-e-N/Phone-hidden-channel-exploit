import pandas as pd
import credentials
from pymongo import MongoClient
from bson import ObjectId

client = MongoClient()
client = MongoClient('mongodb://%s:%s@54.235.235.226:27017' % (credentials._username, credentials._password))
db_name = 'firstdb'
db = client[db_name]

# returns a list of all dataframes/post corresponding to input
def getDataframe(user_name, orientation, surface, column = None):
    posts = db.posts
    out = []
    for post in posts.find():
        if post["user_name"].lower() == user_name.lower() \
            and post["orientation"].lower() == orientation.lower() \
                and post["surface"].lower() == surface.lower():
            if column: out.append(post[column])
            else: out.append(post)
    return out

post = getDataframe('leo','horizontal','soft')
data = pd.DataFrame.from_dict(post)
import ast
buttonRecords = ast.literal_eval(data["buttonRecords"][0])
print("over")